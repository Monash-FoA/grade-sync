steps:
- type: require
  wait_message: "Download mark sheet to data/mark_sheet.xlsx"
  path: data/mark_sheet.xlsx
  lifetime: 24
# Create a sheet in `mark_sheet.xlsx` called `Testing`.
- type: sheet
  path: data/mark_sheet.xlsx
  sheet: Testing
  sections:
    id:
      # Grab the ID from the Students Details section
      type: ID
      path: data/mark_sheet.xlsx
      display: "Information"
      sheet: "Student Details"
      header_row: 2
      source: "Student ID"
      dest: "Student ID"
    info:
      type: Lookup
      path: data/mark_sheet.xlsx
      display: "Information"
      sheet: "Student Details"
      header_row: 2
      items:
        - source: "Email"
          dest: "Email"
        - source: "First Name"
          dest: "First Name"
        - source: "Last Name"
          dest: "Last Name"
        - source: "Campus"
          dest: "Campus"
        - source: "Marker A2"
          dest: "Marker"
        - source: "A2 Due Date"
          dest: "Due Date"
        - source: "Group ID 2"
          dest: "Group ID"
    ed:
      type: Ed
      display: Ed
      path: data/ed.csv
      criterion: configurations/ed/criteria/2023/S1/A2.json
      sheet_lookup: Email
      grade_lookup: email
      group_lookup: Group ID
    comp:
      type: Computed
      display: Autogenerated
      items:
        - source: "ed['ed_mark'] + ed['ed_mark']"
          dest: Double Mark