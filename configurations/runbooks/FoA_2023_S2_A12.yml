steps:
- type: require
  wait_message: "Download mark sheet: {secrets[2023_S2_MARK_SHEET]} to data/mark_sheet.xlsx"
  path: data/mark_sheet.xlsx
  lifetime: 24
- type: sheet
  path: data/mark_sheet.xlsx
  sheet: A1.2 Marks
  compute_scripts:
  - scripts/compute/utils.py
  - scripts/compute/feedback.py
  sections:
    id:
      type: ID
      path: data/mark_sheet.xlsx
      display: "Information"
      sheet: "Top Level Info"
      header_row: 2
      source: "Student ID"
      dest: "Student ID"
    info:
      type: Lookup
      path: data/mark_sheet.xlsx
      display: "Information"
      sheet: "Top Level Info"
      header_row: 2
      items:
        - source: "Email"
          dest: "Email"
        - source: "First Name"
          dest: "First Name"
        - source: "Last Name"
          dest: "Last Name"
        - source: "Unit Code"
          dest: "Unit Code"
        - source: "Campus"
          dest: "Campus"
        - source: "Marker A1"
          dest: "Marker"
        - source: "A1 Due Date"
          dest: "Due Date"
    interview:
      type: Lookup
      path: data/mark_sheet.xlsx
      display: Interview
      sheet: A1 Interview Log
      header_row: 2
      items:
        - source: Interview Multiplier
          dest: Multiplier
        - source: Q1
          dest: Q1 Mark
        - source: Q2
          dest: Q2 Mark
        - source: Q3
          dest: Q3 Mark
        - source: Q4
          dest: Q4 Mark
        - source: Q5
          dest: Q5 Mark
        - source: Q6
          dest: Q6 Mark
        - source: Q1 Feedback
          dest: Q1 Feedback
        - source: Q2 Feedback
          dest: Q2 Feedback
        - source: Q3 Feedback
          dest: Q3 Feedback
        - source: Q4 Feedback
          dest: Q4 Feedback
        - source: Q5 Feedback
          dest: Q5 Feedback
        - source: Q6 Feedback
          dest: Q6 Feedback
        - source: Q1 Response
          dest: Q1 Response
        - source: Q2 Response
          dest: Q2 Response
        - source: Q3 Response
          dest: Q3 Response
        - source: Q4 Response
          dest: Q4 Response
        - source: Q5 Response
          dest: Q5 Response
        - source: Q6 Response
          dest: Q6 Response
    comp:
      type: Computed
      display: Autogenerated
      items:
        - source: "utils.gen_mark_2023_s2_a12(O)"
          dest: "Total Mark"
        - source: "utils.gen_feedback_2023_s2_a12(O)"
          dest:   "Feedback"
- type: command
  command: python -m scripts.xml_export data/mark_sheet.xlsx "A1.2 Marks" {secrets[2023_S2_A12_ID]} data/grades.xml -mark "Total Mark"
- type: confirm
  message: "Import grades from data/grades.xml to {secrets[2023_S2_XML_UPDATE]}"
